<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

    <title>Zoggle - Rewritten Using AngularJS - Zolmeister</title>
    <meta name="description" content="Zolmeister- Blog" />
    <link href='http://zolmeister.com/favicon.ico' rel='icon' type='image/x-icon'/>

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

    <!-- RSS -->
    <link rel="alternate" type="application/atom+xml" title="Zolmeister - Atom" href="http://www.zolmeister.com/feeds/posts/default" />
    <link rel="alternate" type="application/rss+xml" title="Zolmeister - RSS" href="http://www.zolmeister.com/feeds/posts/default?alt=rss" />

</head>
<body class="home-template">


    <main class="content" role="main">

    <article class="post">
        <header class="post-header">
            <a id="blog-logo" href="/">
                
                    <span class="blog-title">Zolmeister</span>
                
            </a>
        </header>

        <span class="post-meta">
        	<time datetime="2014-01-07">07 Jan 2014</time>
        	<!--
        		on
	        	
	        -->
       	</span>

        <h1 class="post-title"><a href="">Zoggle - Rewritten Using AngularJS</a></h1>

        <section class="post-content">
            <p><a href="http://4.bp.blogspot.com/-2mf8hrqg5zw/UsdX3VlNL9I/AAAAAAAABkk/acSzRrCi4Xs/s1600/banner2.png"><img src="http://4.bp.blogspot.com/-2mf8hrqg5zw/UsdX3VlNL9I/AAAAAAAABkk/acSzRrCi4Xs/s640/banner2.png" alt=""></a></p>

<h4>Zoggle, the ultimate word game!</h4>

<p>Play <a href="http://zoggle.zolmeister.com/">Zoggle</a> (<a href="https://github.com/Zolmeister/Zoggle">source</a>) FREE on:</p>

<p><a href="https://play.google.com/store/apps/details?id=zolmeister.zman.zoggle" imageanchor="1" style="float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-5TYDOf_4nWo/UstXHii97zI/AAAAAAAABm8/eEaTaNLJ4tY/s1600/google_play_store_logo_ungarische-Produkte_online.png" height="80"></a></p>

<p><a href="https://chrome.google.com/webstore/detail/zoggle/makbpnhaoldbpinpacbppcefmonaimlf" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" src="http://4.bp.blogspot.com/-KWn2qgBFK-k/UstTgx7kE4I/AAAAAAAABlw/NdU1RkAJQiM/s1600/blog_chrome.png" height="80"></a><br></p>

<p><a href="http://www.amazon.com/gp/product/B00HO06T1S/ref=as_li_ss_tl?ie=UTF8&amp;camp=1789&amp;creative=390957&amp;creativeASIN=B00HO06T1S&amp;linkCode=as2&amp;tag=zolmeister-20" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-XDl9CZa98ng/UstTgotHwdI/AAAAAAAABls/o-BFWVvVUgo/s1600/amazon-icon-final-large-512512.jpg"></a></p>

<p><a href="https://marketplace.firefox.com/app/zoggle" imageanchor="1" style="margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-iJ8wh5BLYiE/UstSg833EDI/AAAAAAAABlk/E3cHsJsht3w/s1600/firefox-marketplace_logo-wordmark_RGB.png" height="80"></a></p>

<h4>A Long Time Ago...</h4>

<p>Zoggle was my very first app on Google Play, and also happened to be the topic of my first blog post over a year ago:&nbsp;<a href="http://www.zolmeister.com/2012/04/zoggle.html">http://www.zolmeister.com/2012/04/zoggle.html</a>. I finally got around to giving it a proper upgrade by rebuilding from the ground up. Zoggle is now better than ever, with a new theme, less bugs, and an illustriously impeccable code-base.</p>

<p><a href="http://2.bp.blogspot.com/-tItuDOFfbCY/UsuFeYxmZ0I/AAAAAAAABng/G6yomhoEsKg/s1600/zoggle1.png"><img src="http://2.bp.blogspot.com/-tItuDOFfbCY/UsuFeYxmZ0I/AAAAAAAABng/G6yomhoEsKg/s1600/zoggle1.png" alt=""></a> <a href="http://zoggle.zolmeister.com/"><img src="http://1.bp.blogspot.com/-ushK9k-_sw4/UsuFgeOZ-CI/AAAAAAAABno/v1troMq_AMo/s1600/zoggle2.png" alt=""></a></p>

<h4>Round 2</h4>

<p><a href="http://www.christopherlaughlin.co.uk/wp-content/uploads/2013/10/grunt-logo.png"><img src="http://www.christopherlaughlin.co.uk/wp-content/uploads/2013/10/grunt-logo.png" alt=""></a></p>

<p>Originally Zoggle was built using many javascript and css hacks (not maintainable) and depended zero external libraries (not even jQuery). As a result, it quickly became messy spaghetti code, making even simple changes take hours to implement and test.</p>

<p>Now, after 6 days and 74 commits (and many hours of lost sleep), I finished re-writing Zoggle using <a href="http://angularjs.org/">AngularJS</a>, <a href="http://jquery.com/">jQuery</a>, <a href="http://lodash.com/">Lo-Dash</a>, and <a href="http://gruntjs.com/">Grunt</a> to create a highly maintainable and scalable application. So, without further ado, let&#39;s go over some of the key aspects of the re-write.</p>

<p><a href="http://angularjs.org/img/AngularJS-large.png"><img src="http://angularjs.org/img/AngularJS-large.png" alt=""></a></p>

<h4>Boggle Library</h4>

<p>While searching NPM for a boggle library (before writing my own), I came across <a href="https://npmjs.org/package/boggle">Boggle</a>&nbsp;which leverages <a href="http://en.wikipedia.org/wiki/Trie">tries</a> (mentioned in my <a href="http://www.zolmeister.com/2012/04/zoggle.html">original blog post</a>) for optimal performance. However the library had some issues (no &#39;Qu&#39; single tile support), and a poor dictionary list. I contacted the developer&nbsp;<a href="https://github.com/bahmutov">bahmutov</a>, got the code moved to GitHub, and added the features. (He was also awesome enough to let me push to npm and the core repo, so you may want to check out his <a href="http://bahmutov.calepin.co/">blog</a>).</p>

<h4>AngularJS</h4>

<p>What can I say, except that AngularJS is absolutely amazing! It has a few bugs (you&#39;ve been warned), but it is incredible to work with and makes webdev even more fun and exciting than before. If you&#39;re new to Angular, I recommend <a href="http://www.ng-newsletter.com/advent2013/#!/">25 days of AngularJS</a>, and checking out the <a href="https://github.com/angular/angular-seed">Angular-Seed</a> project. I won&#39;t be writing a tutorial, but some things to watch out for.</p>

<h4>AngularJS Gotchas</h4>

<ul>
<li><p><del>Data-binding on primitives (string, num, bool) doesn&#39;t always work properly.</del> Update: updating primitives from views doesn&#39;t work as expected (<a href="https://github.com/angular/angular.js/wiki/Understanding-Scopes">more info</a>).</p></li>
<li><p>Either nest data inside an object {} or call $scope.$apply()*   Directives can be called before the DOM is ready</p></li>
</ul>

<h4>Boggle Board</h4>

<p>I could have rendered the board using either the DOM or Canvas (or WebGL) but I opted for using the DOM. One issue I ran across when writing the original Zoggle was that touch-move events <a href="http://stackoverflow.com/questions/12396635/crossing-over-to-new-elements-during-touchmove">do not cross over elements</a>. This meat that I had to use the document.elementFromPoint() function in the original Zoggle. Unfortunately, it does not perform well on mobile, so this time around I decided to overlay a div over the whole board and calculate the position of the mouse over the elements manually. Unlike the non-performant code in the <a href="http://stackoverflow.com/a/12397041/2780143">stackoverflow answer</a>, I cached the position of the elements so that detection would be much faster.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">positions</span> <span class="o">=</span> <span class="p">[];</span>

<span class="kd">function</span> <span class="nx">cachePos</span><span class="p">()</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">targets</span> <span class="o">=</span> <span class="nx">$el</span><span class="p">.</span><span class="nx">parent</span><span class="p">().</span><span class="nx">find</span><span class="p">(</span><span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="nx">attrs</span><span class="p">.</span><span class="nx">targets</span><span class="p">)</span>
  <span class="nx">positions</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="nx">targets</span><span class="p">.</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">i</span><span class="p">,</span> <span class="nx">$el</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">$el</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">$el</span><span class="p">)</span>
    <span class="nx">positions</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>
      <span class="nx">x</span><span class="o">:</span> <span class="nx">$el</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">left</span><span class="p">,</span>
      <span class="nx">y</span><span class="o">:</span> <span class="nx">$el</span><span class="p">.</span><span class="nx">offset</span><span class="p">().</span><span class="nx">top</span><span class="p">,</span>
      <span class="nx">w</span><span class="o">:</span> <span class="nx">$el</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">(),</span>
      <span class="nx">h</span><span class="o">:</span> <span class="nx">$el</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span>
    <span class="p">})</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">collide</span><span class="p">(</span><span class="nx">x1</span><span class="p">,</span> <span class="nx">y1</span><span class="p">,</span> <span class="nx">w1</span><span class="p">,</span> <span class="nx">h1</span><span class="p">,</span> <span class="nx">x2</span><span class="p">,</span> <span class="nx">y2</span><span class="p">,</span> <span class="nx">w2</span><span class="p">,</span> <span class="nx">h2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">y1</span> <span class="o">+</span> <span class="nx">h1</span> <span class="o">&lt;</span> <span class="nx">y2</span> <span class="o">||</span> <span class="nx">y1</span> <span class="o">&gt;</span> <span class="nx">y2</span> <span class="o">+</span> <span class="nx">h2</span> <span class="o">||</span> <span class="nx">x1</span> <span class="o">+</span> <span class="nx">w1</span> <span class="o">&lt;</span> <span class="nx">x2</span> <span class="o">||</span> <span class="nx">x1</span> <span class="o">&gt;</span> <span class="nx">x2</span> <span class="o">+</span> <span class="nx">w2</span><span class="p">)</span> <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
  <span class="k">return</span> <span class="kc">true</span>
<span class="p">}</span>
</code></pre></div>
<h4>Letter Interpolation</h4>

<p>The boggle board is represented internally as a single list (of 16 characters) because it made rendering easy. The logical thing (which I didn&#39;t do) would be to clone the data (as it&#39;s static per-game) and represent it as a 2D array. Anyways, one great feature I added to Zoggle was the ability to interpolate between two tiles. This means if you touch one tile (mobile device) and move too quickly and end up 2 tiles over, the algorithm will add the missing tile(s). The algorithm is pretty simple (see bonus for explanation of touching function):</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">touching</span><span class="p">(</span><span class="nx">x1</span><span class="p">,</span> <span class="nx">y1</span><span class="p">,</span> <span class="nx">x2</span><span class="p">,</span> <span class="nx">y2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">flatten</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">zip</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">))),</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">first</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">compact</span><span class="p">)),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dir</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x1</span><span class="o">+</span><span class="nx">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">x2</span> <span class="o">&amp;&amp;</span> <span class="nx">y1</span><span class="o">+</span><span class="nx">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">y2</span>
  <span class="p">})</span>
<span class="p">}</span>

<span class="k">while</span> <span class="p">(</span><span class="o">!</span><span class="nx">touching</span><span class="p">(</span><span class="nx">x1</span><span class="p">,</span> <span class="nx">y1</span><span class="p">,</span> <span class="nx">x2</span><span class="p">,</span> <span class="nx">y2</span><span class="p">))</span> <span class="p">{</span>
  <span class="c1">// interpolate position</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">x1</span> <span class="o">&lt;</span> <span class="nx">x2</span><span class="p">)</span> <span class="nx">x1</span><span class="o">++</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">x1</span> <span class="o">&gt;</span> <span class="nx">x2</span><span class="p">)</span> <span class="nx">x1</span><span class="o">--</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">y1</span> <span class="o">&lt;</span> <span class="nx">y2</span><span class="p">)</span> <span class="nx">y1</span><span class="o">++</span>
  <span class="k">if</span><span class="p">(</span><span class="nx">y1</span> <span class="o">&gt;</span> <span class="nx">y2</span><span class="p">)</span> <span class="nx">y1</span><span class="o">--</span>
  <span class="c1">// add new y1 x1 to selected</span>
<span class="p">}</span>
</code></pre></div>
<h4>Real-Time Word Highlighting</h4>

<p>Another amazing new feature I added was highlighting as you type. The code for this is a simple depth-first search, except that instead of searching it adds every valid visited node as selected.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">depthFirstSearch</span><span class="p">(</span><span class="nx">grid</span><span class="p">,</span> <span class="nx">word</span><span class="p">,</span> <span class="nx">pos</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">past</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">index</span> <span class="o">=</span> <span class="nx">index</span> <span class="o">||</span> <span class="mi">0</span>
  <span class="nx">past</span> <span class="o">=</span> <span class="nx">past</span> <span class="o">||</span> <span class="p">[]</span>
  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">word</span><span class="p">[</span><span class="nx">index</span><span class="p">])</span> <span class="k">return</span> <span class="nx">past</span>
  <span class="kd">var</span> <span class="nx">currentLetter</span> <span class="o">=</span> <span class="nx">grid</span><span class="p">[</span><span class="nx">pos</span><span class="p">]</span>
  <span class="c1">// visiting a previous node or out of bounds</span>
  <span class="k">if</span> <span class="p">(</span><span class="nx">pos</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">pos</span> <span class="o">&gt;</span> <span class="nx">grid</span><span class="p">.</span><span class="nx">length</span> <span class="o">||</span>
    <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">(</span><span class="nx">past</span><span class="p">,</span> <span class="nx">pos</span><span class="p">)</span> <span class="o">||</span>
    <span class="nx">word</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">!==</span> <span class="nx">currentLetter</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[]</span>

  <span class="c1">// cardinal directions (N,S,E,W) + diagonals (NW, NE, SW, SE) in 1D</span>
  <span class="kd">var</span> <span class="nx">dirs</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dir</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">col</span> <span class="o">=</span> <span class="nx">pos</span> <span class="o">%</span> <span class="mi">4</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">col</span> <span class="o">===</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">],</span> <span class="nx">dir</span><span class="p">)</span>
      <span class="k">return</span> <span class="kc">false</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">col</span> <span class="o">===</span> <span class="mi">3</span> <span class="o">&amp;&amp;</span> <span class="nx">_</span><span class="p">.</span><span class="nx">contains</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="nx">dir</span><span class="p">)</span>
      <span class="k">return</span> <span class="kc">false</span>
    <span class="k">return</span> <span class="kc">true</span>
  <span class="p">})</span>

  <span class="c1">// recurse</span>
  <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">dirs</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dir</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">depthFirstSearch</span><span class="p">(</span><span class="nx">grid</span><span class="p">,</span> <span class="nx">word</span><span class="p">,</span> <span class="nx">pos</span> <span class="o">+</span> <span class="nx">dir</span><span class="p">,</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">past</span><span class="p">.</span><span class="nx">concat</span><span class="p">(</span><span class="nx">pos</span><span class="p">))</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></div>
<h4>Minification and Concatenation</h4>

<p>For any production application, minifying and concatenating JS source is essential for an optimal user experience. To automate the process, I used Grunt which is an amazingly powerful tool for running a multitude of tasks.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">grunt</span><span class="p">)</span> <span class="p">{</span>

  <span class="nx">grunt</span><span class="p">.</span><span class="nx">initConfig</span><span class="p">({</span>
    <span class="nx">concat</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">lib</span><span class="o">:</span> <span class="p">{</span>
        <span class="c1">// order matters because jQuery needs to come before angular</span>
        <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;public/lib/*.js&#39;</span><span class="p">,</span> <span class="s1">&#39;public/lib/angular/**/*.js&#39;</span><span class="p">],</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;public/dist/lib.js&#39;</span>
      <span class="p">},</span>
      <span class="nx">zoggle</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;public/js/**/*.js&#39;</span><span class="p">],</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;public/dist/zoggle.js&#39;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">ngmin</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">zoggle</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">src</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= concat.zoggle.dest %&gt;&#39;</span><span class="p">],</span>
        <span class="nx">dest</span><span class="o">:</span> <span class="s1">&#39;public/dist/zoggle.ngmin.js&#39;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">uglify</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">lib</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">sourceMap</span><span class="o">:</span> <span class="s1">&#39;public/dist/lib.js.map&#39;</span><span class="p">,</span>
          <span class="nx">sourceMappingURL</span><span class="o">:</span> <span class="s1">&#39;dist/lib.js.map&#39;</span><span class="p">,</span>
          <span class="nx">sourceMapPrefix</span><span class="o">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
          <span class="s1">&#39;public/dist/lib.min.js&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= concat.lib.dest %&gt;&#39;</span><span class="p">]</span>
        <span class="p">}</span>
      <span class="p">},</span>
      <span class="nx">zoggle</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">options</span><span class="o">:</span> <span class="p">{</span>
          <span class="nx">sourceMap</span><span class="o">:</span> <span class="s1">&#39;public/dist/zoggle.js.map&#39;</span><span class="p">,</span>
          <span class="nx">sourceMappingURL</span><span class="o">:</span> <span class="s1">&#39;dist/zoggle.js.map&#39;</span><span class="p">,</span>
          <span class="nx">sourceMapPrefix</span><span class="o">:</span> <span class="mi">1</span>
        <span class="p">},</span>
        <span class="nx">files</span><span class="o">:</span> <span class="p">{</span>
          <span class="s1">&#39;public/dist/zoggle.min.js&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;&lt;%= ngmin.zoggle.dest %&gt;&#39;</span><span class="p">]</span>
        <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">});</span>

  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-contrib-uglify&#39;</span><span class="p">);</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-contrib-concat&#39;</span><span class="p">);</span>
  <span class="nx">grunt</span><span class="p">.</span><span class="nx">loadNpmTasks</span><span class="p">(</span><span class="s1">&#39;grunt-ngmin&#39;</span><span class="p">);</span>

  <span class="nx">grunt</span><span class="p">.</span><span class="nx">registerTask</span><span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;concat&#39;</span><span class="p">,</span> <span class="s1">&#39;ngmin&#39;</span><span class="p">,</span> <span class="s1">&#39;uglify&#39;</span><span class="p">]);</span>

<span class="p">};</span>
</code></pre></div>
<p>And set this in package.json to use grunt on Heroku:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="s2">&quot;scripts&quot;</span><span class="o">:</span> <span class="p">{</span>
  <span class="s2">&quot;postinstall&quot;</span><span class="o">:</span> <span class="s2">&quot;echo postinstall time; ./node_modules/grunt-cli/bin/grunt&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>A few things to note though. AngularJS injection relies on the variable names in functions. These change during compression, which is why it is necessary to use <a href="https://github.com/btford/ngmin">ngmin</a>&nbsp;to prepare AngularJS code for compression. Additionally, the Angular-Seed project adds unnecessary files under /lib which must be deleted. Minified code (.min.js) (and source maps) should never be committed to source (add them to .gitignore), and should always be generated at compile time (by Grunt). Oh, and AngularJS is picky about what order you need to include jQuery (before Angular), or you may get unexpected errors.</p>

<h4>Android application</h4>

<p>Originally the mobile application was simply a web-view which pointed to the website, but I wanted to add a message in case there was no internet access. I figured that using Cordova (PhoneGap) would make it simple. I was wrong, but in the future I will be able to do it in mere minutes. Read my previous post on how to take a webapp and turn it into a native android mobile application in 5 minutes.&nbsp;<a href="http://www.zolmeister.com/2014/01/how-to-turn-webapp-into-native-android.html">http://www.zolmeister.com/2014/01/how-to-turn-webapp-into-native-android.html</a></p>

<h4>Bonus</h4>

<p>Recall the touching function from above:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">touching</span><span class="p">(</span><span class="nx">x1</span><span class="p">,</span> <span class="nx">y1</span><span class="p">,</span> <span class="nx">x2</span><span class="p">,</span> <span class="nx">y2</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">_</span><span class="p">.</span><span class="nx">some</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">flatten</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">zip</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">))),</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">first</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">compact</span><span class="p">)),</span> <span class="kd">function</span><span class="p">(</span><span class="nx">dir</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x1</span><span class="o">+</span><span class="nx">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">x2</span> <span class="o">&amp;&amp;</span> <span class="nx">y1</span><span class="o">+</span><span class="nx">dir</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">===</span> <span class="nx">y2</span>
  <span class="p">})</span>
<span class="p">}</span>
</code></pre></div>
<p>For fun, I decided to write a functional-only (using only LoDash functions) generator for the 8 cardinal directions (2D) - N, S, E, W, NW, NE, SW, SE. That list ([[0,1],[0,-1],[1,0],[-1,0],[-1,1]...]) is what populates &#39;dir&#39; in the function call. Let&#39;s see how I composed it:</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Here is the original</span>
<span class="kd">var</span> <span class="nx">dirs</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">flatten</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">zip</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)),</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">))),</span><span class="o">!</span><span class="mi">0</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">first</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">compact</span><span class="p">))</span>

<span class="c1">// Now let&#39;s decompose it</span>

<span class="c1">// [-1, 0, 1]</span>
<span class="kd">var</span> <span class="nx">oneDimention</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">// this first one is probably the most difficult to understand</span>
<span class="c1">// n -&gt; [n, n, n]</span>
<span class="kd">var</span> <span class="nx">repeat3</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">,</span> <span class="nx">oneDimention</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">),</span><span class="nx">_</span><span class="p">.</span><span class="nx">identity</span><span class="p">)</span>

<span class="c1">// n -&gt; [[n, -1], [n, 0], [n, 1]]</span>
<span class="kd">var</span> <span class="nx">addToEachDimention</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">partial</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">zip</span><span class="p">,</span> <span class="nx">oneDimention</span><span class="p">),</span> <span class="nx">repeat3</span><span class="p">)</span>

<span class="c1">// create a 3d matrix by joining 3x1 * 1x3 matrix</span>
<span class="c1">// [ [[-1, -1], [-1, 0], [-1, 1]], [[0, -1], [0, 0], [0, 1]], [[1, -1], [1, 0], [1, 1]] ]</span>
<span class="kd">var</span> <span class="nx">created3D</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">oneDimention</span><span class="p">,</span> <span class="nx">addToEachDimention</span><span class="p">)</span>

<span class="c1">// flatten</span>
<span class="c1">// [ [-1, -1], [-1, 0], [-1, 1], [0, -1], [0, 0], [0, 1], [1, -1], [1, 0], [1, 1] ]</span>
<span class="kd">var</span> <span class="nx">created2D</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">flatten</span><span class="p">(</span><span class="nx">created3D</span><span class="p">,</span> <span class="o">!</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">// removes [0, 0] from list</span>
<span class="c1">//[ [-1, -1], [-1, 0], [-1, 1], [0, -1], [0, 1], [1, -1], [1, 0], [1, 1] ]</span>
<span class="kd">var</span> <span class="nx">removedCenter</span> <span class="o">=</span> <span class="nx">_</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">created2D</span><span class="p">,</span> <span class="nx">_</span><span class="p">.</span><span class="nx">compose</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">first</span><span class="p">,</span><span class="nx">_</span><span class="p">.</span><span class="nx">compact</span><span class="p">))</span>
</code></pre></div>
        </section>

        

        <footer class="post-footer">
        	<!-- If we want to display author's name and bio -->
            
                <section class="author">
                	<header> <a href=""> <img class="profile" src="/assets/images/profile.png" alt="Zolmeister"></a></header>
                	<article>
                		<!-- Author Name -->
                    	<h4> Zoli Kahan </h4>
                    	<!-- Author Bio -->
                    	<p>
                    		<a target="_blank" href="http://insignia.zolmeister.com">Projects</a> |
                        <a target="_blank" href="https://github.com/Zolmeister">GitHub</a> |
                        <a target="_blank" href="http://clay.io">Clay.io</a>
                    	</p>
                    </article>
                </section>
            

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Zoggle - Rewritten Using AngularJS&amp;url=http://zolmeister.com/2014/01/zoggle-rewritten-using-angularjs.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=http://zolmeister.com/2014/01/zoggle-rewritten-using-angularjs.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=http://zolmeister.com/2014/01/zoggle-rewritten-using-angularjs.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

            
            <section class="disqus">
        	    <div id="disqus_thread"></div>
              <script type="text/javascript">
                  /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
                  var disqus_shortname = 'zolmeister'; // required: replace example with your forum shortname

                  /* * * DON'T EDIT BELOW THIS LINE * * */
                  (function() {
                      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                      dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                  })();
              </script>

            </section>
            

        </footer>

    </article>

</main>


    <footer class="site-footer">
        <a class="subscribe icon-feed" href="feeds/posts/default"><span class="tooltip">Subscribe!</span></a>
        <div class="inner">
             <section class="copyright">All content copyright <a href="">Zolmeister</a> &copy;  &bull; All rights reserved.</section>
        </div>
    </footer>


    <script type="text/javascript" src="/assets/js/jquery-1.10.2.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics Tracking code -->
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-30570115-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
</body>
</html>
